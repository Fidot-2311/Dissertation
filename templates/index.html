<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitch Perfect Prediction</title>
    <style>
        body {
            background: url('https://i.imgur.com/R6cpurn.jpg') no-repeat center center fixed;
            background-size: cover;
            font-family: Arial, sans-serif;
            color: #fff;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        form {
            max-width: 600px;
            margin: auto;
            background-color: #2E7D32;
            padding: 20px;
            border-radius: 10px;
        }
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            color: #fff;
        }
        .description {
            font-size: 12px;
            color: #ccc;
            margin-top: 5px;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .football-btn {
            background: url('https://i.imgur.com/rGSEBFp.png') no-repeat center center;
            background-size: contain;
            background-color: #fff;
            width: 80px;
            height: 80px;
            border: 2px solid #FFC107;
            border-radius: 50%;
            cursor: pointer;
            margin: auto;
            display: block;
            margin-top: 20px;
            border: none;
            outline: none;
            transition: transform 0.2s;
        }
        .football-btn:hover {
            transform: scale(1.1);
        }
        button {
            background-color: #FFC107;
            color: #000;
            padding: 15px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        button:hover {
            background-color: #FFEB3B;
        }
        #reset-btn {
            background-color: #4CAF50;
            color: #fff;
            font-size: 14px;
            padding: 10px 15px;
            width: auto;
            display: block;
            margin: 20px auto;
            border: none;
            border-radius: 5px;
        }
        #reset-btn:hover {
            background-color: #66BB6A;
        }
        .result {
            margin-top: 20px;
            background-color: #1B5E20;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .result ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .result li {
            margin: 10px 0;
        }
        .spinner {
            display: none;
            margin: 20px auto;
            border: 8px solid #f3f3f3;
            border-radius: 50%;
            border-top: 8px solid #4CAF50;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>Pitch Perfect Prediction</h1>
    <form id="prediction-form">
        <div class="form-group">
            <label for="TouDef3rd">TouDef3rd:</label>
            <input type="number" id="TouDef3rd" name="TouDef3rd" min="0.01" step="any" required>
            <div class="description">Touches in defensive 1/3</div>
        </div>
        <div class="form-group">
            <label for="TI">TI:</label>
            <input type="number" id="TI" name="TI" min="0.01" step="any" required>
            <div class="description">Throw-Ins taken</div>
        </div>
        <div class="form-group">
            <label for="PasTotPrgDist">PasTotPrgDist:</label>
            <input type="number" id="PasTotPrgDist" name="PasTotPrgDist" min="0.01" step="any" required>
            <div class="description">Total distance, in yards, that completed passes have traveled towards the opponent's goal</div>
        </div>
        <div class="form-group">
            <label for="Clr">Clr:</label>
            <input type="number" id="Clr" name="Clr" min="0.01" step="any" required>
            <div class="description">Clearances</div>
        </div>
        <div class="form-group">
            <label for="PasDead">PasDead:</label>
            <input type="number" id="PasDead" name="PasDead" min="0.01" step="any" required>
            <div class="description">Dead-ball passes</div>
        </div>
        <div class="form-group">
            <label for="TouDefPen">TouDefPen:</label>
            <input type="number" id="TouDefPen" name="TouDefPen" min="0.01" step="any" required>
            <div class="description">Touches in defensive penalty area</div>
        </div>
        <div class="form-group">
            <label for="RecProg">RecProg:</label>
            <input type="number" id="RecProg" name="RecProg" min="0.01" step="any" required>
            <div class="description">Completed passes that move the ball towards the opponent's goal at least 10 yards from its furthest point in the last six passes, or any completed pass into the penalty area</div>
        </div>
        <div class="form-group">
            <label for="PasMedCmp">PasMedCmp:</label>
            <input type="number" id="PasMedCmp" name="PasMedCmp" min="0.01" step="any" required>
            <div class="description">Passes completed (Passes between 15 and 30 yards)</div>
        </div>
        <div class="form-group">
            <label for="TouAttPen">TouAttPen:</label>
            <input type="number" id="TouAttPen" name="TouAttPen" min="0.01" step="any" required>
            <div class="description">Touches in attacking penalty area</div>
        </div>
        <div class="form-group">
            <label for="TouAtt3rd">TouAtt3rd:</label>
            <input type="number" id="TouAtt3rd" name="TouAtt3rd" min="0.01" step="any" required>
            <div class="description">Touches in attacking 1/3</div>
        </div>
        <div class="form-group">
            <label for="PasFK">PasFK:</label>
            <input type="number" id="PasFK" name="PasFK" min="0.01" step="any" required>
            <div class="description">Passes attempted from free kicks</div>
        </div>
        <div class="form-group">
            <label for="PasTotCmp">PasTotCmp:</label>
            <input type="number" id="PasTotCmp" name="PasTotCmp" min="0.01" step="any" required>
            <div class="description">Passes completed</div>
        </div>
        <div class="form-group">
            <label for="TouMid3rd">TouMid3rd:</label>
            <input type="number" id="TouMid3rd" name="TouMid3rd" min="0.01" step="any" required>
            <div class="description">Touches in middle 1/3</div>
        </div>
        <div class="form-group">
            <label for="Shots">Shots:</label>
            <input type="number" id="Shots" name="Shots" min="0.01" step="any" required>
            <div class="description">Shots total (Does not include penalty kicks)</div>
        </div>
        <div class="form-group">
            <label for="Pas3rd">Pas3rd:</label>
            <input type="number" id="Pas3rd" name="Pas3rd" min="0.01" step="any" required>
            <div class="description">Completed passes that enter the 1/3 of the pitch closest to the goal</div>
        </div>
        <div class="form-group">
            <label for="Recov">Recov:</label>
            <input type="number" id="Recov" name="Recov" min="0.01" step="any" required>
            <div class="description">Number of loose balls recovered</div>
        </div>
        <div class="form-group">
            <label for="SCA">SCA:</label>
            <input type="number" id="SCA" name="SCA" min="0.01" step="any" required>
            <div class="description">Shot-creating actions</div>
        </div>
        <div class="form-group">
            <label for="TklMid3rd">TklMid3rd:</label>
            <input type="number" id="TklMid3rd" name="TklMid3rd" min="0.01" step="any" required>
            <div class="description">Tackles in middle 1/3</div>
        </div>
        <div class="form-group">
            <label for="ToAtt">ToAtt:</label>
            <input type="number" id="ToAtt" name="ToAtt" min="0.01" step="any" required>
            <div class="description">Number of attempts to take on defenders while dribbling</div>
        </div>
        <button type="submit" class="football-btn"></button>
        <button type="button" id="reset-btn">Reset</button>
    </form>
    <div class="spinner" id="spinner"></div>
    <div class="result" id="result"></div>

    <script>
        document.getElementById("prediction-form").addEventListener("submit", function(event) {
            event.preventDefault();
            let formData = new FormData(this);
            let jsonData = {};
            formData.forEach((value, key) => { 
                let numberValue = Number(value);
                if (numberValue <= 0) {
                    alert(`${key} must be greater than 0.`);
                    return;
                }
                jsonData[key] = numberValue; 
            });

            document.getElementById("spinner").style.display = "block"; // Show spinner
            document.getElementById("result").innerHTML = "";

            fetch("/predict", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify([jsonData])
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("spinner").style.display = "none"; // Hide spinner
                let resultDiv = document.getElementById("result");
                let predictions = data.predictions;
                let probabilities = data.predictions_proba;

                // Class labels
                let classLabels = ["Defender", "Forward", "Midfielder"];

                let predictionHTML = "<h3>Prediction</h3><p>" + classLabels[predictions[0]] + "</p>";
                let probabilitiesHTML = "<h3>Probabilities</h3><ul>";
                probabilities[0].forEach((probability, index) => {
                    probabilitiesHTML += "<li>" + classLabels[index] + ": " + (probability * 100).toFixed(2) + "%</li>";
                });
                probabilitiesHTML += "</ul>";

                resultDiv.innerHTML = predictionHTML + probabilitiesHTML;
            })
            .catch(error => {
                document.getElementById("spinner").style.display = "none"; // Hide spinner
                document.getElementById("result").innerHTML = "<p style='color: red;'>An error occurred. Please try again.</p>";
                console.error('Error:', error);
            });
        });

        document.getElementById("reset-btn").addEventListener("click", function() {
            document.getElementById("prediction-form").reset();
            document.getElementById("result").innerHTML = "";
        });
    </script>
</body>
</html>
